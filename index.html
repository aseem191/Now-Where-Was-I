<!DOCTYPE html>
<html>

<head>
	<title>Now where Was I?</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.js"></script>
	

	<script>
		$(document).ready(function(){
			var placelist = [];
			$('#postButton').click(function() {
				window.location.href = 'create.html';
				return false;
			});

			$('#placeInput').on('input', function() {
				console.log($("#placeInput").val())
				if($("#placeInput").val() == ""){
					$("#mylist").empty();
					$("#mylist").append(
						placelist.map(place => {
							var mylink = $("<a>").text(place);
							mylink.attr("href", "place.html?place=" + place);
							return $("<div class='item'></div>").append(mylink);
						})
					)
				}
				else{
					$("#mylist").empty();
					var searchplacelist = [];
					for(var i = 0; i < placelist.length; i++){
						if(placelist[i].includes($("#placeInput").val())){
							searchplacelist.push(placelist[i]);
						}
					}

					$("#mylist").append(
						searchplacelist.map(place => {
							var mylink = $("<a>").text(place);
							mylink.attr("href", "place.html?place=" + place);
							return $("<div class='item'></div>").append(mylink);
						})
					)
				}
			});

			$.getJSON("https://desolate-castle-53665.herokuapp.com/thoughts", function(data, status){
				$("#mylist").empty();

				var origplacelist = [];
				for(var i = 0; i < data._embedded.thoughts.length; i++){
					origplacelist.push(data._embedded.thoughts[i].place);
				}
				placelist = Array.from(new Set(origplacelist));

				$("#mylist").append(
					placelist.map(place => {
						var mylink = $("<a>").text(place);
						mylink.attr("href", "place.html?place=" + place);
						return $("<div class='item'></div>").append(mylink);
					})
				)
			})
		})

		
	</script>

</head>
<body>
	<div align="center">
		<br>
		<h1>Now where Was I?</h1>
		<br><br><br>
		<h3>Where are you right now?</h3>
		<br><br>

		<form class="myform">
			<div class="ui input"><input type="text" name="place" id="placeInput"></div>
		</form>
		<br>

		<div style="width:300px" class="ui relaxed divided list" id="mylist">
			<h5>Loading items...</h5>
		</div>
		<br><br>
		<button class="ui button" id="postButton">
			Post your own realization here!
		</button>
	</div>
</body>
</html>